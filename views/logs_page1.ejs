<!DOCTYPE html>

<html>
<head> 
<%- include sidebar %>
    <style type="text/css">

    .myLogsTable{
        width:100% ;
        border: 1px solid black;
        font-family:'Agency FB';
    }
    h1{
        text-align:center;
    }
    #logshistory{
        width:100%;
        border: 1px solid black;
        font-family:'Agency FB';
    }
    
input[type="text"] {
    width: 200px;
}

input[type="datetime-local"] {
    width: 200px;
}

input[type="methodlist"] {
    width: 200px;
}

select { width: 200px;}

.alignTB{
    margin-left: 30px;
}


    </style>
    <meta charset="utf-8" />
    <title></title>
</head>

<body>
<div class="padding">
        <form id="supNameForm" method="POST" action="/home/suppliers/logs">
            <select id="supNameSelect" name="supplierName1">
            <option selected disabled>Selecet Supplier</option>
          </select>
        </form>
    <h1> <b>+ New log</b></h1>
        <table  class="myLogsTable"> 
            <tr><th>Supplier Name</th>
            <th>Store num</th>
            <th class="alignTB">Date of conversion</th>
            <th class="alignTB">  Subject</th>
            <th> communication method</th>
            <th>Content</th>
            <th> Cancel</th>
            </tr>
            </table>
            <div id="logRow">
            <form method="post" action="/home/suppliers/logs">
            <table  class="myLogsTable" cellspacing="10">
            <tr ><td class="alignTB"></td>
                <td>
                <select id="storeNumSelect" placeholder="Store Number" name="storeNum">
                        <option selected disabled>Select Store Num</option>
                      </select>
                </td>
            <td> <input type="datetime-local" name="dateOfConversion"/></td>
            <td> <input type="text" placeholder="Subject" name="subject" /></td>
            <td> <select name="methodList">
            <option value="mail">Mail</option>
            <option value="wechat">Wechat</option>
            <option value="skype">Skype</option>
            <option value="phone">Phone</option>
                 </select> </td>
            <td> <input type="text" placeholder="Content" name="content" /></td>
            <td> <input type="reset" value="Clear" /> </td>
            </tr>
        </table>
        <div style="text-align:center"><button id="submitbutt" type="submit" value="Submit">Submit</button></div>
        </form>
        <button type="button" onclick="LogsFormClone()">+Add new log</button>
        </div>

        <div id="newLogRow"></div>

        <h1><% if (answer.message.length > 0) { %> <div><%= answer.message %></div> <% } %></h1>

        <script>
        function LogsFormClone() {
            var itm = document.getElementById("logRow");
            var cln = itm.cloneNode(true);
            document.getElementById("newLogRow").appendChild(cln);
        }
        </script>
        
<!--///////////////////////////////////////////////////////////////////////////////////////////////////////-->


    <h1> Logs history</h1>

    <div style="text-align:center"><form id="supForm" method="POST" action="/home/suppliers/logs">
        <select id="supSelect" name="supplierName">
          <option selected disabled>Selecet Supplier</option>
        </select>
        </form></div><br>

    <table id="logshistory">
        <tr>
            <th> Store num</th>
            <th>Supplier Name</th>
            <th>Date of conversion</th>
            <th> Subject</th>
            <th> communication method</th>
            <th> Content</th>
        </tr>
        <tr> <td id= "storeNumLogs"></td>
            <td id="supplierNameLogs"> </td>
            <td id="dateOfConversionLogs"> </td>
            <td id="titleLogs"> </td>
            <td id="communicationMethodLogs"> </td>
            <td id="contentLogs"> </td>
        </tr>

        </table>

  
    </div>
    
    <script>


//-----------------------------------------------Load Logs History----------------------------------------------------------------

                     var logsListRes = JSON.parse('<%-JSON.stringify(answer.logsListRes)%>');
                     console.log(logsListRes);
                     var storeNum = '';
                     var supplierName = '';
                     var dateOfConversion = '';
                     var title = '';
                     var communicationMethod = '';
                     var content = '';
                     var i = '';

                     for (i = 0; i < logsListRes.length; i++) { 
                     storeNum += logsListRes[i].storeNum + "<br><br>";
                     supplierName += logsListRes[i].supplierName + "<br><br>";
                     dateOfConversion += logsListRes[i].dateOfConversion + "<br><br>";
                     title += logsListRes[i].title + "<br><br>";
                     communicationMethod += logsListRes[i].communicationMethod + "<br><br>";
                     content += logsListRes[i].content + "<br><br>";
                     }
                     
                     document.getElementById("storeNumLogs").innerHTML = storeNum;
                     document.getElementById("supplierNameLogs").innerHTML = supplierName;
                     document.getElementById("dateOfConversionLogs").innerHTML = dateOfConversion;
                     document.getElementById("titleLogs").innerHTML = title;
                     document.getElementById("communicationMethodLogs").innerHTML = communicationMethod;
                     document.getElementById("contentLogs").innerHTML = content;


//-----------------------------------------------Load Filtered Supplier Logs List----------------------------------------------------------------
                    
                    var supplierFirstNameRes = JSON.parse('<%-JSON.stringify(answer.supplierNameMenuRes)%>');
                        
                    var select = document.getElementById("supSelect");
                    for(index in supplierFirstNameRes) {
                        select.options[select.options.length] = new Option(supplierFirstNameRes[index], supplierFirstNameRes[index]);
                    }

                    document.getElementById("supSelect").onchange = function() {
                            document.getElementById("supForm").submit();
                    }
                        
 //-----------------------------------------------Load Suppliers Options----------------------------------------------------------------

                    var supplierNameRes = JSON.parse('<%-JSON.stringify(answer.supplierNameRes)%>');

                    var select = document.getElementById("supNameSelect");

                    for(index in supplierNameRes) {
                        select.options[select.options.length] = new Option(supplierNameRes[index], supplierNameRes[index]);
                    }
                    document.getElementById("supNameSelect").onchange = function() {
                        document.getElementById("supNameForm").submit();
                    }
                    

                    var storeNumRes = JSON.parse('<%-JSON.stringify(answer.storeNumRes)%>');

                    var select = document.getElementById("storeNumSelect");
                    for(index in storeNumRes) {
                        select.options[select.options.length] = new Option(storeNumRes[index], storeNumRes[index]);
                    }
          </script> 

   
</body>
</html>